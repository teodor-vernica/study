<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Page</title>
    <link rel="stylesheet" href="../page-templates/task-page.css">
    <script src="../../../revisitUtilities/revisit-communicate.js"></script>
    <script type="module">
        import {Registry, initializeTrrack} from 'https://cdn.jsdelivr.net/npm/@trrack/core@1.3.0/+esm'

        const initialState = {
            selectedButton: 'task-description'
        };

        const registry = Registry.create();

        const clickButton = registry.register(
            'click-tab',
            (state, task) => {
                state.selectedButton = task;
                return state;
            }
        );

        const trrack = initializeTrrack({
            initialState,
            registry
        });

        window.trrack = trrack;

        window.showContent = function(page, button) {
            document.querySelectorAll('.content').forEach(div => div.style.display = 'none');
            document.getElementById(page).style.display = 'block';
            document.querySelectorAll('.tab').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            trrack.apply('Change data view', clickButton(page));

            // Save the current state to ReVISit
            saveToReVISit();
        }

        trrack.currentChange(() => {
            const selectedButton = trrack.getState().selectedButton;
            document.querySelectorAll('.tab').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('onclick').includes(selectedButton));
            });
            document.querySelectorAll('.content').forEach(div => {
                div.style.display = div.id === selectedButton ? 'block' : 'none';
            });

            // Save the current state to ReVISit
            saveToReVISit();
        });

        function saveToReVISit() {
            Revisit.postAnswers({
                selectedButton: trrack.getState().selectedButton
            });
            Revisit.postProvenance(trrack.graph.backend);
            // console.log(trrack.graph.backend)
        }

        // Call saveToReVISit when the page is about to unload (e.g., when closing the tab)
        window.addEventListener('beforeunload', saveToReVISit);
    </script>
    <!-- <script type="module" src="../page-templates/trrack-setup-main.js"></script> -->
</head>
<body>
    <div class="tabs">
        <div class="tab active" onclick="showContent('task-description', this)">Task description</div>
        <div class="tab" onclick="showContent('lca-results', this)">LCA results</div>
        <div class="tab" onclick="showContent('process-tree', this)">Process tree</div>
        <div class="tab" onclick="showContent('cad-model', this)">CAD model</div>
        <div class="tab" onclick="showContent('cad-drawings', this)">CAD drawings</div>
        <div class="tab" onclick="showContent('fea-results', this)">FEA results</div>
        <div class="tab" onclick="showContent('lcad-app', this)">3D LCA Visualizasion</div>
    </div>
    <div id="task-description" class="content">
        <iframe src="task-description-training.html" width="100%" height="500px"></iframe>
    </div>
    <div id="lca-results" class="content">
        <!-- <iframe src="../page-templates/lca-results.html" width="100%" height="500px"></iframe> -->
        <!-- <div class="subtabs">
            <div class="subtab active" onclick="showContent('lca-results-processes', this)">Processes</div>
            <div class="subtab" onclick="showContent('lca-results-components', this)">Components</div>
        </div> -->
        <!-- <div id="lca-results-processes" class="subcontent">
            <h2>Add process level LCA results here.</h2>
        </div>
        <div id="lca-results-components" class="subcontent">
            <h2>Add component level LCA results here.</h2>
        </div> -->
        <h2> Process contribution</h2>
        <table border="1">
            <tr>
              <th>Calculation</th>
              <td>Analyze</td>
            </tr>
            <tr>
              <th>Results</th>
              <td>Process contribution</td>
            </tr>
            <tr>
              <th>Product</th>
              <td>1 p _FlangeManufacturing (of project Teo_LCADEvaluation)</td>
            </tr>
            <tr>
              <th>Method</th>
              <td>ReCiPe 2016 Midpoint (H) V1.00</td>
            </tr>
            <tr>
              <th>Indicator</th>
              <td>Inventory</td>
            </tr>
            <tr>
              <th>Default units</th>
              <td>Yes</td>
            </tr>
            <tr>
              <th>Exclude infrastructure processes</th>
              <td>No</td>
            </tr>
            <tr>
              <th>Exclude long-term emissions</th>
              <td>No</td>
            </tr>
            <tr>
              <th>Sorted on item</th>
              <td>Process</td>
            </tr>
            <tr>
              <th>Sort order</th>
              <td>Ascending</td>
            </tr>
          </table>
          
          <table border="1">
            <tr>
              <th>No</th>
              <th>Process</th>
              <th>Project</th>
              <th>Unit</th>
              <th>Total</th>
              <th>Steel, chromium steel 18/8 {GLO}| market for | Alloc Def, S</th>
              <th>Chromium steel removed by turning, average, computer numerical controlled {RER}| chromium steel turning, average, computer numerical controlled | Alloc Def, S</th>
              <th>Forging, steel {GLO}| market for | Alloc Def, S</th>
              <th>Steel removed by drilling, conventional {RER}| steel drilling, conventional | Alloc Def, S</th>
              <th>Powder coat, steel {RER}| powder coating, steel | Alloc Def, S</th>
              <th>Chromium steel removed by turning, average, computer numerical controlled {RER}| chromium steel turning, average, computer numerical controlled | Alloc Def, S</th>
            </tr>
            <tr>
              <td>1</td>
              <td>Chromium steel removed by turning, average, computer numerical controlled {RER}| chromium steel turning, average, computer numerical controlled | Alloc Def, S</td>
              <td>Ecoinvent 3 - allocation, default - system</td>
              <td>kg</td>
              <td>0.017</td>
              <td>0</td>
              <td>0.009</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0.008</td>
            </tr>
            <tr>
              <td>2</td>
              <td>Forging, steel {GLO}| market for | Alloc Def, S</td>
              <td>Ecoinvent 3 - allocation, default - system</td>
              <td>kg</td>
              <td>0.675</td>
              <td>0</td>
              <td>0</td>
              <td>0.675</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>3</td>
              <td>Powder coat, steel {RER}| powder coating, steel | Alloc Def, S</td>
              <td>Ecoinvent 3 - allocation, default - system</td>
              <td>m2</td>
              <td>0.006</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0.006</td>
              <td>0</td>
            </tr>
            <tr>
              <td>4</td>
              <td>Steel removed by drilling, conventional {RER}| steel drilling, conventional | Alloc Def, S</td>
              <td>Ecoinvent 3 - allocation, default - system</td>
              <td>kg</td>
              <td>0.0872</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0.0872</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>5</td>
              <td>Steel, chromium steel 18/8 {GLO}| market for | Alloc Def, S</td>
              <td>Ecoinvent 3 - allocation, default - system</td>
              <td>kg</td>
              <td>0.81</td>
              <td>0.81</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
          </table>
    
          <h2> Impact assessment</h2>

          <img src="../data/ImpactAssessment.JPG" style="width: 100%; height: auto;"></img>

          <table border="1">
            <tr>
              <th>Calculation</th>
              <td>Analyze</td>
            </tr>
            <tr>
              <th>Results</th>
              <td>Impact assessment</td>
            </tr>
            <tr>
              <th>Product</th>
              <td>1 p _FlangeManufacturing (of project Teo_LCADEvaluation)</td>
            </tr>
            <tr>
              <th>Method</th>
              <td>ReCiPe 2016 Midpoint (H) V1.00</td>
            </tr>
            <tr>
              <th>Indicator</th>
              <td>Characterization</td>
            </tr>
            <tr>
              <th>Skip categories</th>
              <td>With factor = 0</td>
            </tr>
            <tr>
              <th>Exclude infrastructure processes</th>
              <td>No</td>
            </tr>
            <tr>
              <th>Exclude long-term emissions</th>
              <td>No</td>
            </tr>
            <tr>
              <th>Sorted on item</th>
              <td>Impact category</td>
            </tr>
            <tr>
              <th>Sort order</th>
              <td>Ascending</td>
            </tr>
          </table>
          
          <table border="1">
            <tr>
              <th>Impact category</th>
              <th>Unit</th>
              <th>Total</th>
              <th>Steel, chromium steel 18/8 {GLO}| market for | Alloc Def, S</th>
              <th>Chromium steel removed by turning, average, computer numerical controlled {RER}| chromium steel turning, average, computer numerical controlled | Alloc Def, S</th>
              <th>Forging, steel {GLO}| market for | Alloc Def, S</th>
              <th>Steel removed by drilling, conventional {RER}| steel drilling, conventional | Alloc Def, S</th>
              <th>Powder coat, steel {RER}| powder coating, steel | Alloc Def, S</th>
              <th>Chromium steel removed by turning, average, computer numerical controlled {RER}| chromium steel turning, average, computer numerical controlled | Alloc Def, S</th>
            </tr>
            <tr>
              <td>Global warming</td>
              <td>kg CO2 eq</td>
              <td>4.915325086</td>
              <td>3.812118992</td>
              <td>0.068067058</td>
              <td>0.677145415</td>
              <td>0.279513331</td>
              <td>0.017976238</td>
              <td>0.060504052</td>
            </tr>
            <tr>
              <td>Stratospheric ozone depletion</td>
              <td>kg CFC11 eq</td>
              <td>1.52373E-06</td>
              <td>1.12745E-06</td>
              <td>2.39307E-08</td>
              <td>2.39299E-07</td>
              <td>9.51369E-08</td>
              <td>1.66434E-08</td>
              <td>2.12718E-08</td>
            </tr>
            <tr>
              <td>Ionizing radiation</td>
              <td>kBq Co-60 eq</td>
              <td>0.224469124</td>
              <td>0.159231663</td>
              <td>0.007649282</td>
              <td>0.034379882</td>
              <td>0.013974706</td>
              <td>0.002434228</td>
              <td>0.006799362</td>
            </tr>
            <tr>
              <td>Ozone formation, Human health</td>
              <td>kg NOx eq</td>
              <td>0.012298922</td>
              <td>0.010059033</td>
              <td>0.000159504</td>
              <td>0.00125938</td>
              <td>0.000646987</td>
              <td>3.22366E-05</td>
              <td>0.000141782</td>
            </tr>
            <tr>
              <td>Fine particulate matter formation</td>
              <td>kg PM2.5 eq</td>
              <td>0.016391302</td>
              <td>0.014180779</td>
              <td>0.000196086</td>
              <td>0.001265957</td>
              <td>0.000553129</td>
              <td>2.10512E-05</td>
              <td>0.000174299</td>
            </tr>
            <tr>
              <td>Ozone formation, Terrestrial ecosystems</td>
              <td>kg NOx eq</td>
              <td>0.012602789</td>
              <td>0.010283745</td>
              <td>0.000163391</td>
              <td>0.001302201</td>
              <td>0.00067433</td>
              <td>3.38863E-05</td>
              <td>0.000145236</td>
            </tr>
            <tr>
              <td>Terrestrial acidification</td>
              <td>kg SO2 eq</td>
              <td>0.022260905</td>
              <td>0.018178613</td>
              <td>0.000305317</td>
              <td>0.002353354</td>
              <td>0.001093825</td>
              <td>5.84029E-05</td>
              <td>0.000271393</td>
            </tr>
            <tr>
              <td>Freshwater eutrophication</td>
              <td>kg P eq</td>
              <td>0.002057755</td>
              <td>0.001453212</td>
              <td>3.16208E-05</td>
              <td>0.000348605</td>
              <td>0.000189431</td>
              <td>6.77863E-06</td>
              <td>2.81074E-05</td>
            </tr>
            <tr>
              <td>Terrestrial ecotoxicity</td>
              <td>kg 1,4-DCB e</td>
              <td>0.018008556</td>
              <td>0.01677898</td>
              <td>0.000200719</td>
              <td>0.000525816</td>
              <td>0.000317211</td>
              <td>7.41186E-06</td>
              <td>0.000178417</td>
            </tr>
            <tr>
              <td>Freshwater ecotoxicity</td>
              <td>kg 1,4-DCB e</td>
              <td>0.284989255</td>
              <td>0.211816597</td>
              <td>0.003354084</td>
              <td>0.040447669</td>
              <td>0.025963008</td>
              <td>0.000426489</td>
              <td>0.002981408</td>
            </tr>
            <tr>
              <td>Marine ecotoxicity</td>
              <td>kg 1,4-DBC e</td>
              <td>0.413942282</td>
              <td>0.310982295</td>
              <td>0.00482178</td>
              <td>0.056912851</td>
              <td>0.036335214</td>
              <td>0.000604116</td>
              <td>0.004286026</td>
            </tr>
            <tr>
              <td>Human carcinogenic toxicity</td>
              <td>kg 1,4-DBC e</td>
              <td>1.772213915</td>
              <td>1.383522842</td>
              <td>0.017864789</td>
              <td>0.218090103</td>
              <td>0.135962753</td>
              <td>0.000893616</td>
              <td>0.015879812</td>
            </tr>
            <tr>
                <td>Human non-carcinogenic toxicity</td>
                <td>kg 1,4-DBC e</td>
                <td>192.8044396</td>
                <td>123.0184025</td>
                <td>2.215415908</td>
                <td>39.98178504</td>
                <td>25.21436687</td>
                <td>0.405210683</td>
                <td>1.969258585</td>
              </tr>
              <tr>
                <td>Land use</td>
                <td>m2a crop eq</td>
                <td>0.161700907</td>
                <td>0.130139585</td>
                <td>0.003165737</td>
                <td>0.010139968</td>
                <td>0.014928826</td>
                <td>0.000512803</td>
                <td>0.002813988</td>
              </tr>
              <tr>
                <td>Mineral resource scarcity</td>
                <td>kg Cu eq</td>
                <td>0.43025094</td>
                <td>0.399115609</td>
                <td>0.004539969</td>
                <td>0.013845578</td>
                <td>0.008676936</td>
                <td>3.73201E-05</td>
                <td>0.004035528</td>
              </tr>
              <tr>
                <td>Fossil resource scarcity</td>
                <td>kg oil eq</td>
                <td>1.110680432</td>
                <td>0.830362786</td>
                <td>0.015359457</td>
                <td>0.184885691</td>
                <td>0.060664906</td>
                <td>0.005754741</td>
                <td>0.013652851</td>
              </tr>
              <tr>
                <td>Water consumption</td>
                <td>m3</td>
                <td>0.026488802</td>
                <td>0.018251618</td>
                <td>0.000573621</td>
                <td>0.003914463</td>
                <td>0.003025229</td>
                <td>0.000213986</td>
                <td>0.000509885</td>
              </tr>
            </table>
            

    </div>
    <div id="process-tree" class="content">
        <img src="../data/Emissions.JPG" style="width: 100%; height: auto;"></img>
    </div>
    <div id="cad-model" class="content">
        <iframe src="model-viewer-training.html" width="100%" height="500px"></iframe>
    </div>
    <div id="cad-drawings" class="content">
        <h2>[Add CAD drawings here]</h2>
    </div>
    <div id="fea-results" class="content">
        <h2>[PLACE HOLDER]</h2>
        <img src="../data/PH-FEA-results.png" style="height: 50%; width: 50%;"></img>
    </div>
    <div id="lcad-app" class="content">
        <iframe src="../unity-app/index.html" title="3D Visualization" width="1010" height="440" style="border:none;"></iframe>
    </div>
</body>
</html>
